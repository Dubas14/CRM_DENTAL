# Мобільний Додаток - Scope

## Огляд

Мінімальний scope для майбутнього мобільного додатку. Наразі на паузі, але визначено основні вимоги та залежності.

## Цільова аудиторія

### 1. Пацієнти

**Основні функції:**
- Перегляд своїх записів
- Запис до лікаря
- Нагадування про записи
- Перегляд історії візитів

### 2. Лікарі (Майбутнє)

**Можливі функції:**
- Перегляд розкладу
- Підтвердження/скасування записів
- Перегляд пацієнтів

## Мінімальний функціонал (MVP)

### Для пацієнтів

#### 1. Автентифікація
- Реєстрація (email/phone)
- Вхід (email + password)
- Відновлення пароля
- Вихід

#### 2. Записи
- **Перегляд записів:**
  - Список майбутніх записів
  - Деталі запису (дата, час, лікар, процедура)
  - Історія минулих записів

- **Створення запису:**
  - Вибір лікаря
  - Вибір процедури
  - Вибір доступного слота
  - Підтвердження запису

- **Управління записом:**
  - Скасування запису
  - Перенесення запису (якщо доступно)

#### 3. Нагадування
- Push-нотифікації про майбутні записи
- Нагадування за 24 години
- Нагадування за 2 години

#### 4. Профіль
- Перегляд профілю
- Редагування контактних даних
- Налаштування нагадувань

## Технічні вимоги

### API залежності

**Обов'язково:**
- API versioning (v1) - для стабільності
- i18n підтримка - для локалізації
- Push-нотифікації API - для нагадувань

**Базові endpoints:**
```
POST   /api/v1/auth/register
POST   /api/v1/auth/login
POST   /api/v1/auth/logout
GET    /api/v1/user
GET    /api/v1/appointments
POST   /api/v1/appointments
GET    /api/v1/appointments/{id}
PUT    /api/v1/appointments/{id}
DELETE /api/v1/appointments/{id}
GET    /api/v1/doctors
GET    /api/v1/doctors/{id}/slots
GET    /api/v1/procedures
```

### Технології (рекомендації)

**Варіанти:**
1. **Flutter** (крос-платформенний)
   - Один код для iOS та Android
   - Швидка розробка

2. **React Native** (крос-платформенний)
   - Використання JavaScript/TypeScript
   - Спільна кодова база з web

3. **Native** (окремі додатки)
   - Swift для iOS
   - Kotlin для Android
   - Максимальна продуктивність

**Рекомендація:** Flutter або React Native для швидкої розробки MVP.

## Структура API для мобільного

### Автентифікація

```
POST /api/v1/mobile/auth/register
{
  "email": "user@example.com",
  "phone": "+380501234567",
  "password": "password",
  "full_name": "Іван Петренко"
}

POST /api/v1/mobile/auth/login
{
  "email": "user@example.com",
  "password": "password"
}

Response:
{
  "token": "auth_token",
  "refresh_token": "refresh_token",
  "user": { ... }
}
```

### Записи

```
GET /api/v1/mobile/appointments
Query params:
  - status: planned, completed, cancelled
  - from_date: YYYY-MM-DD
  - to_date: YYYY-MM-DD

Response:
{
  "data": [
    {
      "id": 1,
      "doctor_name": "Іван Іванов",
      "procedure_name": "Чистка зубів",
      "start_at": "2024-01-15T10:00:00Z",
      "end_at": "2024-01-15T11:00:00Z",
      "status": "planned",
      "clinic_name": "Стоматологія"
    }
  ]
}
```

### Доступні слоти

```
GET /api/v1/mobile/doctors/{id}/slots
Query params:
  - date: YYYY-MM-DD
  - procedure_id: 1

Response:
{
  "slots": [
    {
      "start": "10:00",
      "end": "11:00",
      "available": true
    }
  ]
}
```

## Push-нотифікації

### Налаштування

**Таблиця: user_push_tokens**

```php
Schema::create('user_push_tokens', function (Blueprint $table) {
    $table->id();
    $table->foreignId('user_id')->constrained();
    $table->string('device_type'); // ios, android
    $table->text('token');
    $table->boolean('enabled')->default(true);
    $table->timestamps();
});
```

### Відправка

**Сервіс:**
- Firebase Cloud Messaging (FCM) для Android
- Apple Push Notification Service (APNs) для iOS

**Endpoint:**
```
POST /api/v1/mobile/push/register
{
  "device_type": "android",
  "token": "fcm_token_here"
}
```

## Локалізація (i18n)

### Підтримувані мови

- Українська (основна)
- Англійська (майбутнє)
- Російська (майбутнє)

### API відповіді

Всі текстові поля повертаються в мові користувача:

```
GET /api/v1/mobile/appointments
Headers:
  Accept-Language: uk-UA

Response:
{
  "status_label": "Заплановано", // Локалізовано
  "procedure_name": "Чистка зубів"
}
```

## Безпека

### Токени

- JWT токени для автентифікації
- Refresh tokens для оновлення
- Термін дії access token: 1 година
- Термін дії refresh token: 30 днів

### Rate Limiting

- Логін: 5 спроб на 15 хвилин
- API запити: 100 запитів на хвилину
- Створення записів: 10 на годину

## UI/UX (Ескізи)

### Екрани

1. **Splash Screen**
   - Логотип
   - Перевірка авторизації

2. **Авторизація**
   - Вхід
   - Реєстрація
   - Відновлення пароля

3. **Головний екран**
   - Найближчий запис (якщо є)
   - Кнопка "Записатися"
   - Список записів

4. **Деталі запису**
   - Інформація про запис
   - Кнопки дій (скасувати, перенести)

5. **Створення запису**
   - Вибір лікаря
   - Вибір процедури
   - Вибір дати/часу
   - Підтвердження

6. **Профіль**
   - Дані користувача
   - Налаштування
   - Вихід

## Релізний процес

### Етапи

1. **MVP (Phase 1)**
   - Авторизація
   - Перегляд записів
   - Створення запису
   - Базові нагадування

2. **Phase 2**
   - Push-нотифікації
   - Перенесення записів
   - Історія візитів

3. **Phase 3**
   - Онлайн-оплата
   - Відгуки
   - Додаткові функції

### Тестування

- Unit тести для бізнес-логіки
- Integration тести для API
- E2E тести для критичних flows
- Beta тестування з реальними користувачами

## Залежності від інших модулів

### Обов'язкові

1. **API Versioning (v1)**
   - Стабільний API контракт
   - Забезпечення сумісності

2. **i18n**
   - Локалізація контенту
   - Підтримка мов

3. **Push-нотифікації**
   - Нагадування про записи
   - Оновлення статусів

### Опційні

1. **Онлайн-оплата**
   - Оплата через додаток
   - Інтеграція з платіжними системами

2. **2FA**
   - Додаткова безпека
   - Біометрична аутентифікація

## Майбутні покращення

- Офлайн режим (кешування даних)
- Біометрична аутентифікація
- Чат з клінікою
- Онлайн-консультації
- Електронні чеки
- Програма лояльності

